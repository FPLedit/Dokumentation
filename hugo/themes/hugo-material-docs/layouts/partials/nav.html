{{ $currentNode := . }}

{{ range .Site.Menus.main.ByWeight }}

{{ $.Scratch.Set "currentMenuEntry" . }}
<li>
  {{ if .HasChildren }}
    <input type="checkbox" class="nav-section-toggle" id="nav-section-toggle-{{ .Name | urlize }}" checked style="display:none"></input>
	<span class="section"><label for="nav-section-toggle-{{ .Name | urlize }}">{{ .Name | title }}</label></span>
    <ul>
      {{ range .Children }}
        {{ $.Scratch.Set "currentMenuEntry" . }}
        {{ partial "nav_link" $currentNode }}
      {{ end }}
    </ul>
  {{ else }}
    {{ partial "nav_link" $currentNode }}
  {{ end }}
</li>
{{ end }}
